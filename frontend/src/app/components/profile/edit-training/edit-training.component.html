<div class="edit-training-component" *ngIf="training">
  <mat-toolbar color="primary" class="toolbar">
    <div class="toolbar__back">
      <button routerLink="user-profile/dashboard" mat-icon-button aria-label="Wstecz">
        <mat-icon>home</mat-icon>
      </button>
    </div>
    <span class="toolbar__title"><span>{{ training.name }}</span></span>

    <button mat-icon-button [matMenuTriggerFor]="menu">
      <mat-icon>more_vert</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="removeTraining(training.id)">
        <mat-icon>delete</mat-icon>
        Usuń trening
      </button>
    </mat-menu>
  </mat-toolbar>

  <section class="page-content">
    <mat-form-field class=full-width>
      <mat-label>Ustaw nazwę treningu</mat-label>
      <input matInput  [(ngModel)]="training.name" (focusout)="changeTrainingName($event)">
    </mat-form-field>
    <form action="" [formGroup]="exerciseForm" (ngSubmit)="onSubmit(exerciseForm)">
      <mat-form-field class="select--full">
        <mat-label>Cwiczenie</mat-label>
        <select matNativeControl #t required formControlName="exercise_type_id" (change)="changeExercise(t.value)">
          <option *ngFor="let exercise of exerciseTypes" [value]="exercise.id">
            {{exercise.name}}
          </option>
        </select>
      </mat-form-field>

      <div class="add-exercises">
        <div class="add-exercises__row">
          <div class="add-exercises__series"></div>
          <div class="add-exercises__reps">
            Powtórzenia
          </div>
          <div class="add-exercises__weight">
            Ciężar
          </div>
          <div class="add-exercises__action">
            Zatwierdź
          </div>
        </div>
        <div class="add-exercises__row">
          <div class="add-exercises__series">
<!--            {{ series.length | async + 1 }}-->
          </div>
          <div class="add-exercises__reps">
            <input type="number" name="reps" formControlName="reps">
          </div>
          <div class="add-exercises__weight">
            <input type="number" formControlName="weight">
          </div>
          <div class="add-exercises__action">
            <button mat-stroked-button [disabled]="!exerciseForm.valid">
              <mat-icon>checked</mat-icon>
            </button>
          </div>
        </div>
        <ng-container>
          <div *ngFor="let ser of series ; let index = index">
            <div class="add-exercises__row">
              <div class="add-exercises__series">

                {{ series.length - index  }}
              </div>
              <div class="add-exercises__reps">
                {{ ser.reps }}
              </div>
              <div class="add-exercises__weight">
                {{ ser.weight }}

              </div>
              <div class="add-exercises__action">
                <button mat-stroked-button color="warn" type="button" (click)="removeExercise(ser.id)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </ng-container>

        <section class="stats" *ngIf="average">
          <div>
            <span class="average">Bilans treningu <strong [ngClass]="{'greater' : (average - averageForSeries) < 0 }">{{ -(average - averageForSeries) }}kg</strong>
            </span>
          </div>
          <div>
            Srednia dla cwiczenia: <strong>{{average}}kg</strong><br>
          </div>
          <div>
            Obecny ciezar w seriach: <strong>{{averageForSeries}}kg</strong>
          </div>
        </section>
      </div>
    </form>

  </section>
  <footer class="app-bottom-menu">
    <button mat-flat-button color="primary" (click)="finishWorkout(training.id)">Zakończ trening</button>

    <button mat-flat-button color="accent" disabled *ngIf="series" (click)="onSync()" type="submit">Synchronizuj ćwiczenia</button>
  </footer>
</div>
